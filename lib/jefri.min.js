!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,d){var e,f,g,h,i,j,k=[].slice;d(1),g=d(2),h=d(4),i=d(3),f=a.exports={EntityComparator:function(a,b){var c;return c=a&&b&&a._type()===b._type()&&a.id()===b.id()},isEntity:function(a){return null==a&&(a={}),a._type&&a.id&&_.isFunction(a._type)&&_.isFunction(a.id)||!1}},e=function(a,b,c){this.entity=a,this.field=b,this.relationship=c},e.prototype=Object.create(Array.prototype),e.prototype.remove=function(a){var b,c;if(null!==a){for(c=this.length-1;c>-1;){if(this[c]._compare(a)){if(this.relationship.back){b=this[c];try{b[this.relationship.back].remove(this)}catch(d){b[this.relationship.back]=null}}this.splice(c,1)}c--}return this}},e.prototype.add=function(a){var b;return b=null,this.entity._relationships[this.field].forEach(function(c){return null==b&&f.EntityComparator(a,c)?b=c:void 0}),null==b&&(this.entity._relationships[this.field].push(a),this.relationship.back&&(a[this.relationship.back]=this.entity)),this.entity},f.Runtime=function(a,b,c){var d,j,l,m,n,o,p,q,r,s;return!this instanceof f.Runtime?new f.Rutime(a,b,c):(d=this,Object.isString(a)||(c=b,b=a,a=""),j={promise:g()},l={updateOnIntern:!0},Object.assign(l,b),Object.assign(this,{settings:l,ready:j.promise,_context:{meta:{},contexts:{},entities:{},attributes:{}},_instances:{}}),r=function(a){switch(a){case"boolean":return!1;case"int":return 0;case"string":return"";default:return""}},s=function(a){return function(b){var c,d,e,f;Object.assign(a._context.attributes,b.attributes||{}),e=b.entities,f=[];for(d in e)c=e[d],f.push(m(c,d));return f}}(this),m=function(a){return function(b,e){return a._context.entities[e]=b,a._instances[e]={},b.Constructor=function(a){var c,e,f,g;Object.assign(this,{_new:!0,_modified:{_count:0},_fields:{},_relationships:{},_runtime:d}),a=a||{},a[b.key]=a[b.key]||i.v4(),g=b.properties;for(e in g)f=g[e],c=a[e]||r(f.type),this[e]=c;return this._id=this.id(!0),Object.assign(this.prototype,a.prototype),this.on("persisted",function(){return this._new=!1,this._modified={_count:0}}),this},b.Constructor.name=e,p(e,b,c&&c[e])}}(this),p=function(){return function(a,b,c){var e,g,h,i,j,k,l,m,p;b.Constructor.prototype=Object.create(Object.assign({},f.EventDispatcher.prototype,{_type:function(b){return b=b||!1,a},id:function(a){return""+(a?this._type()+"/":"")+this[b.key]},_status:function(){return this._new?"NEW":0===this._modified._count?"PERSISTED":"MODIFIED"},_definition:function(){return b},_persist:function(a,b){var c,d;return c=_.Deferred().then(b),d=!a,a=d?new f.Transaction:a,a.add(this),this.emit("persisting",a),d?a.persist(b):void 0},_encode:function(){var a,c;a={_type:this._type(),_id:this.id()};for(c in b.properties)a[c]=this[c];return a},_destroy:_.lock(function(){var a,c,e;this.emit("destroying",{}),e=b.relationships;for(a in e)c=e[a],"has_many"===c.type?this[a].remove(this):this[a]=null;return d.destroy(this),this[b.key]=0,this.emit("destroyed",{})}),_compare:function(a){return f.EntityComparator(this,a)}})),b.Constructor.prototype.toJSON=b.Constructor.prototype._encode,l=b.properties;for(e in l)i=l[e],o(b,e,i);m=b.relationships;for(j in m)k=m[j],q(b,j,k);p=b.methods;for(h in p)g=p[h],n(b,h,g);return c?Object.assign(b.Constructor.prototype,c.prototype):void 0}}(this),o=function(){return function(a,b){return Object.defineProperty(a.Constructor.prototype,b,{set:function(a){return a!==this._fields[b]?(this._fields[b]=a,this._modified[b]?this._modified[b]===a&&(delete this._modified[b],this._modified._count-=1):(this._modified[b]=this._fields[b],this._modified._count+=1),this.emit("modified",[b,a])):void 0},get:function(){return this._fields[b]}})}}(this),q=function(a,b,c){var f,g;return f="has_many"===c.type?{enumerable:!0,configurable:!1,get:function(){var a,f,g;if(!(b in this._relationships)){this._relationships[b]=new e(this,b,c),g=d._instances[c.to.type];for(a in g)f=g[a],f[c.to.property]===this[c.property]&&this._relationships[b].add(f)}return this._relationships[b]},set:function(){var a,c,d,e;for(c=1<=arguments.length?k.call(arguments,0):[],c=c.reduce(function(a,b){return a.concat(b)},[]),this[b],d=0,e=c.length;e>d;d++)a=c[d],this._relationships[b].add(a);return this._modified._count+=1,this.emit("modified",[b,arguments]),this}}:{set:_.lock(function(a){var d,e;if(null===a){if("is_a"!==c.type)try{null!=(d=this._relationships[b])&&d[c.back].remove(this)}catch(f){null!=(e=this._relationships[b])&&(e[c.back]=null)}this._relationships[b]=null,this[c.property]=null}else this._relationships[b]=a,g.call(this,a),"is_a"!==c.type&&c.back&&null!=a&&(a[c.back]=this);return this._modified._count+=1,this.emit("modified",[b,a]),this}),get:function(){var a;return void 0===this._relationships[b]&&(this._relationships[b]=d._instances[c.to.type][this[c.property]],void 0===this._relationships[b]&&(a={},a[c.to.property]=this[c.property],this[b]=d.build(c.to.type,a))),this._relationships[b]}},Object.defineProperty(a.Constructor.prototype,b,f),g=function(b){var d;return void 0===b?this[c.property]=void 0:a.key===c.property?b[c.to.property]=this[c.property]:b._definition().key===c.to.property?this[c.property]=b[c.to.property]:this[c.property].match(i.rvalid)?b[c.to.property]=this[c.property]:b[c.to.property].match(i.rvalid)?this[c.property]=b[c.to.property]:(d=i.v4(),this[c.property]=d,b[c.to.property]=d)}},n=function(a,b,c){var d,e,f;return c={definitions:c.definitions||{},order:c.order||[]},d=c.definitions.javascript||"",f=c.order,d&&!d.match(/window/)?(f.push(d),e=Function.apply(null,f)):e=function(){},a.Constructor.prototype[b]=e},this.load=function(a,b){return h(a).then(function(a){return a=a||"{}",a=_.isString(a)?JSON.parse(a):a,s(a,b),j.promise(!0)})["catch"](function(a){return console.warn(a,a.message),j.reject(a)}).done()},b&&b.debug&&(s(b.debug.context,c),j.promise(!1)),a&&this.load(a,c),this)},j=function(a){var b;return b=a._type(),this[b]||(this[b]=[]),this[b].push(a)},f.Runtime.prototype=Object.create({clear:function(){return this._instances={},this},definition:function(a){return a=("function"==typeof a._type?a._type():void 0)||a,this._context.entities[a]},extend:function(a,b){return this._context.entities[a]&&Object.assign(this._context.entities[a].Constructor.prototype,b.prototype),this},intern:function(a,b){var c,d,e;return null==b&&(b=!1),b=b||this.settings.updateOnIntern,a.length&&!a._type?d=function(){var d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],f.push(this.intern(c,b));return f}.call(this):(b?(e=this._instances[a._type()][a.id()]||a,Object.assign(e._fields,a._fields)):e=this._instances[a._type()][a.id()]||a,this._instances[a._type()][a.id()]=e,e)},build:function(a,b){var c,d,e,f;if(c=this.definition(a),!c)throw"JEFRi::Runtime::build '"+a+"' is not a defined type in this context.";return b=b||{},f=new c.Constructor(b),c.key in b&&(d={_type:a},d[c.key]=b[c.key],e=this.find(d),e.length>0)?(e=e[0],Object.assign(e._fields,f._fields),e):(this._instances[a][f.id()]=f,f)},expand:function(a,b){var c,d,e,f,g,h,i,j;for(b=b||"persisted",c=[],j=a.entities||[],f=0,h=j.length;h>f;f++)e=j[f],d=this.build(e._type,e),d=this.intern(d,!0),c.push(d);for(g=0,i=c.length;i>g;g++)d=c[g],d.emit(b,!0);return a.entities=c},destroy:function(a){return delete this._instances[a._type()][a.id()],this},find:function(a){var b,c,d,e,f;if("string"==typeof a&&(a={_type:a}),f=[],c=this.definition(a._type),e=this._instances[a._type],a.hasOwnProperty(c.key||a.hasOwnProperty("_id")))e[a[c.key]]&&f.push(e[a[c.key]]);else for(b in e)d=e[b],f.push(d);return f}}),f.Transaction=function(a,b){return Object.assign(this,{attributes:{},store:b,entities:a instanceof Array?a:a?[a]:[]})},f.Transaction.prototype=Object.create({encode:function(){var a,b,c,d,e;for(b={attributes:this.attributes,entities:[]},e=this.entities,c=0,d=e.length;d>c;c++)a=e[c],b.entities.push(f.isEntity(a)?a._encode():a);return b},toString:function(){return JSON.stringify(this.encode())},get:function(a){return null==a&&(a=this.store),this.emit("getting",{}),new g(function(b){return a=a||this.store,a.execute("get",this).then(function(){return b(this)})})},persist:function(a){return null==a&&(a=this.store),this.emit("persisting",{}),new g(function(b){return a.execute("persist",this).then(function(a){return function(c){var d,e,f,g;for(g=c.entities,e=0,f=g.length;f>e;e++)d=g[e],d.emit("persisted",{});return a.emit("persisted",{}),b(a)}}(this))})},add:function(a,b){var c,d,e;for(null==b&&(b=!1),a=Array.isArray(a)?a:[].slice.call(arguments,0),d=0,e=a.length;e>d;d++)c=a[d],this.entities.push(c);return this},attributes:function(a){return Object.assign(this.attributes,c(a)),this}})},function(){[].includes||(Array.prototype.includes=function(a){"use strict";var b=Object(this),c=parseInt(b.length)||0;if(0===c)return!1;var d,e=parseInt(arguments[1])||0;e>=0?d=e:(d=c+e,0>d&&(d=0));for(var f;c>d;){if(f=b[d],a===f||a!==a&&f!==f)return!0;d++}return!1}),Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(a){"use strict";if(void 0===a||null===a)throw new TypeError("Cannot convert first argument to object");for(var b=Object(a),c=1;c<arguments.length;c++){var d=arguments[c];if(void 0!==d&&null!==d)for(var e=Object.keys(Object(d)),f=0,g=e.length;g>f;f++){var h=e[f],i=Object.getOwnPropertyDescriptor(d,h);void 0!==i&&i.enumerable&&(b[h]=d[h])}}return b}}),Object.isString||(Object.isString=function(){return"[object String]"===Object.toString.call(contextUri)})},function(a){!function(a){function b(a){return"function"==typeof a}function c(a){"undefined"!=typeof setImmediate?setImmediate(a):"undefined"!=typeof process&&process.nextTick?process.nextTick(a):setTimeout(a,0)}a[0][a[1]]=function d(a){function e(a,b){return null==f&&null!=a&&(f=a,g=b,h.length&&c(function(){for(var a=0;a<h.length;a++)h[a]()})),f}var f,g=[],h=[];return e.then=function(e,i){function j(){try{var a=f?e:i;if(b(a)){var c=function(a){var d,e=0;try{if(a&&("object"==typeof a||b(a))&&b(d=a.then)){if(a===k)throw new TypeError;d.call(a,function(){e++||c.apply(void 0,arguments)},function(a){e++||k(!1,[a])})}else k(!0,arguments)}catch(f){e++||k(!1,[f])}};c(a.apply(void 0,g||[]))}else k(f,g)}catch(d){k(!1,[d])}}var k=d(a);return null!=f?c(j):h.push(j),k},a&&(e=a(e)),e}}("undefined"==typeof a?[window,"Promise"]:[a,"exports"])},function(a){var b={};a.exports=b,b.rvalid=/^\{?[0-9a-f]{8}\-?[0-9a-f]{4}\-?[0-9a-f]{4}\-?[0-9a-f]{4}\-?[0-9a-f]{12}\}?$/i;var c;if("undefined"!=typeof window)c=function(){var a=new Uint8Array(SIZE);return window.crypto.getRandomValues(a),[].slice.call(a)[0]};else{var d=require("crypto");c=function(){try{var a=d.randomBytes(SIZE),b=new Uint8Array(a);return[].slice.call(b)[0]}catch(c){}}}b.v4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=15&c(),d="x"===a?b:3&b|8;return d.toString(16)})}},function(a,b,c){function d(){}function e(a){var b={}.toString.call(a);switch(b){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function f(){if(r.XMLHttpRequest&&("file:"!=r.location.protocol||!r.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){}return!1}function g(a){return a===Object(a)}function h(a){if(!g(a))return a;var b=[];for(var c in a)null!=a[c]&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}function i(a){for(var b,c,d={},e=a.split("&"),f=0,g=e.length;g>f;++f)c=e[f],b=c.split("="),d[decodeURIComponent(b[0])]=decodeURIComponent(b[1]);return d}function j(a){var b,c,d,e,f=a.split(/\r?\n/),g={};f.pop();for(var h=0,i=f.length;i>h;++h)c=f[h],b=c.indexOf(":"),d=c.slice(0,b).toLowerCase(),e=s(c.slice(b+1)),g[d]=e;return g}function k(a){return a.split(/ *; */).shift()}function l(a){return q(a.split(/ *; */),function(a,b){var c=b.split(/ *= */),d=c.shift(),e=c.shift();return d&&e&&(a[d]=e),a},{})}function m(a,b){b=b||{},this.req=a,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method?this.xhr.responseText:null,this.setStatusProperties(this.xhr.status),this.header=this.headers=j(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text):null}function n(a,b){var c=this;p.call(this),this._query=this._query||[],this.method=a,this.url=b,this.header={},this._header={},this.on("end",function(){var a=null,b=null;try{b=new m(c)}catch(d){a=new Error("Parser is unable to parse the response"),a.parse=!0,a.original=d}c.callback(a,b)})}function o(a,b){return"function"==typeof b?new n("GET",a).end(b):1==arguments.length?new n("GET",a):new n(a,b)}var p=c(5),q=c(6),r="undefined"==typeof window?this:window,s="".trim?function(a){return a.trim()}:function(a){return a.replace(/(^\s*|\s*$)/g,"")};o.serializeObject=h,o.parseString=i,o.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},o.serialize={"application/x-www-form-urlencoded":h,"application/json":JSON.stringify},o.parse={"application/x-www-form-urlencoded":i,"application/json":JSON.parse},m.prototype.get=function(a){return this.header[a.toLowerCase()]},m.prototype.setHeaderProperties=function(){var a=this.header["content-type"]||"";this.type=k(a);var b=l(a);for(var c in b)this[c]=b[c]},m.prototype.parseBody=function(a){var b=o.parse[this.type];return b&&a&&a.length?b(a):null},m.prototype.setStatusProperties=function(a){var b=a/100|0;this.status=a,this.statusType=b,this.info=1==b,this.ok=2==b,this.clientError=4==b,this.serverError=5==b,this.error=4==b||5==b?this.toError():!1,this.accepted=202==a,this.noContent=204==a||1223==a,this.badRequest=400==a,this.unauthorized=401==a,this.notAcceptable=406==a,this.notFound=404==a,this.forbidden=403==a},m.prototype.toError=function(){var a=this.req,b=a.method,c=a.url,d="cannot "+b+" "+c+" ("+this.status+")",e=new Error(d);return e.status=this.status,e.method=b,e.url=c,e},o.Response=m,p(n.prototype),n.prototype.use=function(a){return a(this),this},n.prototype.timeout=function(a){return this._timeout=a,this},n.prototype.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},n.prototype.abort=function(){return this.aborted?void 0:(this.aborted=!0,this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this)},n.prototype.set=function(a,b){if(g(a)){for(var c in a)this.set(c,a[c]);return this}return this._header[a.toLowerCase()]=b,this.header[a]=b,this},n.prototype.unset=function(a){return delete this._header[a.toLowerCase()],delete this.header[a],this},n.prototype.getHeader=function(a){return this._header[a.toLowerCase()]},n.prototype.type=function(a){return this.set("Content-Type",o.types[a]||a),this},n.prototype.accept=function(a){return this.set("Accept",o.types[a]||a),this},n.prototype.auth=function(a,b){var c=btoa(a+":"+b);return this.set("Authorization","Basic "+c),this},n.prototype.query=function(a){return"string"!=typeof a&&(a=h(a)),a&&this._query.push(a),this},n.prototype.field=function(a,b){return this._formData||(this._formData=new FormData),this._formData.append(a,b),this},n.prototype.attach=function(a,b,c){return this._formData||(this._formData=new FormData),this._formData.append(a,b,c),this},n.prototype.send=function(a){var b=g(a),c=this.getHeader("Content-Type");if(b&&g(this._data))for(var d in a)this._data[d]=a[d];else"string"==typeof a?(c||this.type("form"),c=this.getHeader("Content-Type"),this._data="application/x-www-form-urlencoded"==c?this._data?this._data+"&"+a:a:(this._data||"")+a):this._data=a;return b?(c||this.type("json"),this):this},n.prototype.callback=function(a,b){var c=this._callback;return this.clearTimeout(),2==c.length?c(a,b):a?this.emit("error",a):void c(b)},n.prototype.crossDomainError=function(){var a=new Error("Origin is not allowed by Access-Control-Allow-Origin");a.crossDomain=!0,this.callback(a)},n.prototype.timeoutError=function(){var a=this._timeout,b=new Error("timeout of "+a+"ms exceeded");b.timeout=a,this.callback(b)},n.prototype.withCredentials=function(){return this._withCredentials=!0,this},n.prototype.end=function(a){var b=this,c=this.xhr=f(),g=this._query.join("&"),h=this._timeout,i=this._formData||this._data;if(this._callback=a||d,c.onreadystatechange=function(){return 4==c.readyState?0==c.status?b.aborted?b.timeoutError():b.crossDomainError():void b.emit("end"):void 0},c.upload&&(c.upload.onprogress=function(a){a.percent=a.loaded/a.total*100,b.emit("progress",a)}),h&&!this._timer&&(this._timer=setTimeout(function(){b.abort()},h)),g&&(g=o.serializeObject(g),this.url+=~this.url.indexOf("?")?"&"+g:"?"+g),c.open(this.method,this.url,!0),this._withCredentials&&(c.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof i&&!e(i)){var j=o.serialize[this.getHeader("Content-Type")];j&&(i=j(i))}for(var k in this.header)null!=this.header[k]&&c.setRequestHeader(k,this.header[k]);return this.emit("request",this),c.send(i),this},o.Request=n,o.get=function(a,b,c){var d=o("GET",a);return"function"==typeof b&&(c=b,b=null),b&&d.query(b),c&&d.end(c),d},o.head=function(a,b,c){var d=o("HEAD",a);return"function"==typeof b&&(c=b,b=null),b&&d.send(b),c&&d.end(c),d},o.del=function(a,b){var c=o("DELETE",a);return b&&c.end(b),c},o.patch=function(a,b,c){var d=o("PATCH",a);return"function"==typeof b&&(c=b,b=null),b&&d.send(b),c&&d.end(c),d},o.post=function(a,b,c){var d=o("POST",a);return"function"==typeof b&&(c=b,b=null),b&&d.send(b),c&&d.end(c),d},o.put=function(a,b,c){var d=o("PUT",a);return"function"==typeof b&&(c=b,b=null),b&&d.send(b),c&&d.end(c),d},a.exports=o},function(a){function b(a){return a?c(a):void 0}function c(a){for(var c in b.prototype)a[c]=b.prototype[c];return a}a.exports=b,b.prototype.on=b.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks[a]=this._callbacks[a]||[]).push(b),this},b.prototype.once=function(a,b){function c(){d.off(a,c),b.apply(this,arguments)}var d=this;return this._callbacks=this._callbacks||{},c.fn=b,this.on(a,c),this},b.prototype.off=b.prototype.removeListener=b.prototype.removeAllListeners=b.prototype.removeEventListener=function(a,b){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c=this._callbacks[a];if(!c)return this;if(1==arguments.length)return delete this._callbacks[a],this;for(var d,e=0;e<c.length;e++)if(d=c[e],d===b||d.fn===b){c.splice(e,1);break}return this},b.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks[a];if(c){c=c.slice(0);for(var d=0,e=c.length;e>d;++d)c[d].apply(this,b)}return this},b.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks[a]||[]},b.prototype.hasListeners=function(a){return!!this.listeners(a).length}},function(a){a.exports=function(a,b,c){for(var d=0,e=a.length,f=3==arguments.length?c:a[d++];e>d;)f=b.call(null,f,a[d],++d,a);return f}}]);