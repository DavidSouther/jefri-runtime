!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,d){var e,f,g,h,i,j,k,l,m=[].slice;d(1),f=d(5),h=d(2),i=d(6),j=d(3),k=d(4),g=a.exports={EntityComparator:function(a,b){var c;return c=a&&b&&a._type()===b._type()&&a.id()===b.id()},isEntity:function(a){return null==a&&(a={}),a._type&&a.id&&Object.isFunction(a._type)&&Object.isFunction(a.id)||!1}},e=function(a,b,c){this.entity=a,this.field=b,this.relationship=c},e.prototype=Object.create(Array.prototype),e.prototype.remove=function(a){var b,c;if(null!==a){for(c=this.length-1;c>-1;){if(this[c]._compare(a)){if(this.relationship.back){b=this[c];try{b[this.relationship.back].remove(this)}catch(d){b[this.relationship.back]=null}}this.splice(c,1)}c--}return this}},e.prototype.add=function(a){var b;return b=null,this.entity._relationships[this.field].forEach(function(c){return null==b&&g.EntityComparator(a,c)?b=c:void 0}),null==b&&(this.entity._relationships[this.field].push(a),this.relationship.back&&(a[this.relationship.back]=this.entity)),this.entity},g.Runtime=function(a,b,c){var d,l,n,o,p,q,r,s,t,u;return!this instanceof g.Runtime?new g.Rutime(a,b,c):(d=this,Object.isString(a)||(c=b,b=a,a=""),l={promise:h()},n={updateOnIntern:!0},Object.assign(n,b),Object.assign(this,{settings:n,ready:l.promise,_context:{meta:{},contexts:{},entities:{},attributes:{}},_instances:{}}),t=function(a){switch(a){case"boolean":return!1;case"int":return 0;case"string":return"";default:return""}},u=function(a){return function(b){var c,d,e,f;Object.assign(a._context.attributes,b.attributes||{}),e=b.entities,f=[];for(d in e)c=e[d],f.push(o(c,d));return f}}(this),o=function(a){return function(b,e){return a._context.entities[e]=b,a._instances[e]={},b.Constructor=function(a){var c,e,f,g;Object.assign(this,{_new:!0,_modified:{_count:0},_fields:{},_relationships:{},_runtime:d}),a=a||{},a[b.key]=a[b.key]||j.v4(),g=b.properties;for(e in g)f=g[e],c=a[e]||t(f.type),this[e]=c;return this._id=this.id(!0),this.on("persisted",function(){return this._new=!1,this._modified={_count:0}}),this},b.Constructor.name=e,r(e,b,c&&c[e])}}(this),r=function(){return function(a,b,c){var e,h,i,j,l,m,n,o,r;b.Constructor.prototype=Object.create(Object.assign({},f.prototype,{_type:function(b){return b=b||!1,a},id:function(a){return""+(a?this._type()+"/":"")+this[b.key]},_status:function(){return this._new?"NEW":0===this._modified._count?"PERSISTED":"MODIFIED"},_definition:function(){return b},_persist:function(a,b){var c,d;return c=_.Deferred().then(b),d=!a,a=d?new g.Transaction:a,a.add(this),this.emit("persisting",a),d?a.persist(b):void 0},_encode:function(){var a,c;a={_type:this._type(),_id:this.id()};for(c in b.properties)a[c]=this[c];return a},_destroy:k(function(){var a,c,e;this.emit("destroying",{}),e=b.relationships;for(a in e)c=e[a],"has_many"===c.type?this[a].remove(this):this[a]=null;return d.destroy(this),this[b.key]=0,this.emit("destroyed",{})}),_compare:function(a){return g.EntityComparator(this,a)}})),b.Constructor.prototype.toJSON=b.Constructor.prototype._encode,n=b.properties;for(e in n)j=n[e],q(b,e,j);o=b.relationships;for(l in o)m=o[l],s(b,l,m);r=b.methods;for(i in r)h=r[i],p(b,i,h);return c?Object.assign(b.Constructor.prototype,c.prototype):void 0}}(this),q=function(){return function(a,b){return Object.defineProperty(a.Constructor.prototype,b,{set:function(a){return a!==this._fields[b]?(this._fields[b]=a,this._modified[b]?this._modified[b]===a&&(delete this._modified[b],this._modified._count-=1):(this._modified[b]=this._fields[b],this._modified._count+=1),this.emit("modified",[b,a])):void 0},get:function(){return this._fields[b]}})}}(this),s=function(a,b,c){var f,g;return f="has_many"===c.type?{enumerable:!0,configurable:!1,get:function(){var a,f,g;if(!(b in this._relationships)){this._relationships[b]=new e(this,b,c),g=d._instances[c.to.type];for(a in g)f=g[a],f[c.to.property]===this[c.property]&&this._relationships[b].add(f)}return this._relationships[b]},set:function(){var a,c,d,e;for(c=1<=arguments.length?m.call(arguments,0):[],c=c.reduce(function(a,b){return a.concat(b)},[]),this[b],d=0,e=c.length;e>d;d++)a=c[d],this._relationships[b].add(a);return this._modified._count+=1,this.emit("modified",[b,arguments]),this}}:{set:k(function(a){var d,e;if(null===a){if("is_a"!==c.type)try{null!=(d=this._relationships[b])&&d[c.back].remove(this)}catch(f){null!=(e=this._relationships[b])&&(e[c.back]=null)}this._relationships[b]=null,this[c.property]=null}else this._relationships[b]=a,g.call(this,a),"is_a"!==c.type&&c.back&&null!=a&&(a[c.back]=this);return this._modified._count+=1,this.emit("modified",[b,a]),this}),get:function(){var a;return void 0===this._relationships[b]&&(this._relationships[b]=d._instances[c.to.type][this[c.property]],void 0===this._relationships[b]&&(a={},a[c.to.property]=this[c.property],this[b]=d.build(c.to.type,a))),this._relationships[b]}},Object.defineProperty(a.Constructor.prototype,b,f),g=function(b){var d;return void 0===b?this[c.property]=void 0:a.key===c.property?b[c.to.property]=this[c.property]:b._definition().key===c.to.property?this[c.property]=b[c.to.property]:this[c.property].match(j.rvalid)?b[c.to.property]=this[c.property]:b[c.to.property].match(j.rvalid)?this[c.property]=b[c.to.property]:(d=j.v4(),this[c.property]=d,b[c.to.property]=d)}},p=function(a,b,c){var d,e,f;return c={definitions:c.definitions||{},order:c.order||[]},d=c.definitions.javascript||"",f=c.order,d&&!d.match(/window/)?(f.push(d),e=Function.apply(null,f)):e=function(){},a.Constructor.prototype[b]=e},this.load=function(a,b){return i(a).then(function(a){return a=a||"{}",a=Object.isString(a)?JSON.parse(a):a,u(a,b),l.promise(!0)})["catch"](function(a){return console.warn(a),console.log(a.stack),l.promise(!1,a)}).done()},b&&b.debug&&(u(b.debug.context,c),l.promise(!1)),a&&this.load(a,c),this)},l=function(a){var b;return b=a._type(),this[b]||(this[b]=[]),this[b].push(a)},g.Runtime.prototype=Object.create({clear:function(){return this._instances={},this},definition:function(a){return a=("function"==typeof a._type?a._type():void 0)||a,this._context.entities[a]},extend:function(a,b){return this._context.entities[a]&&Object.assign(this._context.entities[a].Constructor.prototype,b.prototype),this},intern:function(a,b){var c,d,e;return null==b&&(b=!1),b=b||this.settings.updateOnIntern,a.length&&!a._type?d=function(){var d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],f.push(this.intern(c,b));return f}.call(this):(b?(e=this._instances[a._type()][a.id()]||a,Object.assign(e._fields,a._fields)):e=this._instances[a._type()][a.id()]||a,this._instances[a._type()][a.id()]=e,e)},build:function(a,b){var c,d,e,f;if(c=this.definition(a),!c)throw"JEFRi::Runtime::build '"+a+"' is not a defined type in this context.";return b=b||{},f=new c.Constructor(b),c.key in b&&(d={_type:a},d[c.key]=b[c.key],e=this.find(d),e.length>0)?(e=e[0],Object.assign(e._fields,f._fields),e):(this._instances[a][f.id()]=f,f)},expand:function(a,b){var c,d,e,f,g,h,i,j;for(b=b||"persisted",c=[],j=a.entities||[],f=0,h=j.length;h>f;f++)e=j[f],d=this.build(e._type,e),d=this.intern(d,!0),c.push(d);for(g=0,i=c.length;i>g;g++)d=c[g],d.emit(b,!0);return a.entities=c},destroy:function(a){return delete this._instances[a._type()][a.id()],this},find:function(a){var b,c,d,e,f;if("string"==typeof a&&(a={_type:a}),f=[],c=this.definition(a._type),e=this._instances[a._type],a.hasOwnProperty(c.key||a.hasOwnProperty("_id")))e[a[c.key]]&&f.push(e[a[c.key]]);else for(b in e)d=e[b],f.push(d);return f}}),g.Transaction=function(a,b){return Object.assign(this,{attributes:{},store:b,entities:a instanceof Array?a:a?[a]:[]})},g.Transaction.prototype=Object.create({encode:function(){var a,b,c,d,e;for(b={attributes:this.attributes,entities:[]},e=this.entities,c=0,d=e.length;d>c;c++)a=e[c],b.entities.push(g.isEntity(a)?a._encode():a);return b},toString:function(){return JSON.stringify(this.encode())},get:function(a){return null==a&&(a=this.store),this.emit("getting",{}),new h(function(b){return a=a||this.store,a.execute("get",this).then(function(){return b(this)})})},persist:function(a){return null==a&&(a=this.store),this.emit("persisting",{}),new h(function(b){return a.execute("persist",this).then(function(a){return function(c){var d,e,f,g;for(g=c.entities,e=0,f=g.length;f>e;e++)d=g[e],d.emit("persisted",{});return a.emit("persisted",{}),b(a)}}(this))})},add:function(a,b){var c,d,e;for(null==b&&(b=!1),a=Array.isArray(a)?a:[].slice.call(arguments,0),d=0,e=a.length;e>d;d++)c=a[d],this.entities.push(c);return this},attributes:function(a){return Object.assign(this.attributes,c(a)),this}})},function(){[].includes||(Array.prototype.includes=function(a){"use strict";var b=Object(this),c=parseInt(b.length)||0;if(0===c)return!1;var d,e=parseInt(arguments[1])||0;e>=0?d=e:(d=c+e,0>d&&(d=0));for(var f;c>d;){if(f=b[d],a===f||a!==a&&f!==f)return!0;d++}return!1}),Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(a){"use strict";if(void 0===a||null===a)throw new TypeError("Cannot convert first argument to object");for(var b=Object(a),c=1;c<arguments.length;c++){var d=arguments[c];if(void 0!==d&&null!==d)for(var e=Object.keys(Object(d)),f=0,g=e.length;g>f;f++){var h=e[f],i=Object.getOwnPropertyDescriptor(d,h);void 0!==i&&i.enumerable&&(b[h]=d[h])}}return b}}),Object.isString||(Object.isString=function(a){return"string"==typeof a}),Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),Object.isFunction||(Object.isFunction=function(a){return"function"==typeof a||!1})},function(a,b,c){(function(a,b,c){!function(a){function d(a){return"function"==typeof a}function e(a){return"object"==typeof a}function f(a){"undefined"!=typeof b?b(a):"undefined"!=typeof c&&c.nextTick?c.nextTick(a):setTimeout(a,0)}var g;a[0][a[1]]=function h(a){var b,c=[],i=[],j=function(a,d){return null==b&&null!=a&&(b=a,c=Array.isArray(d)?d:[d],i.length&&f(function(){for(var a=0;a<i.length;a++)i[a]()})),b};return j.then=function(j,k){var l=h(a),m=function(){function a(b){var c,f=0;try{if(b&&(e(b)||d(b))&&d(c=b.then)){if(b===l)throw new TypeError;c.call(b,function(){f++||a.apply(g,arguments)},function(a){f++||l(!1,[a])})}else l(!0,arguments)}catch(h){f++||l(!1,[h])}}try{var f=b?j:k;d(f)?a(f.apply(g,c||[])):l(b,c)}catch(h){l(!1,[h])}};return null!=b?f(m):i.push(m),l},j["catch"]=function(a){return j.then(function(){},a)},j["finally"]=function(a){return j["catch"](function(){return null}).then(a)},j.done=function(){return null},a&&(j=a(j)),j}}([a,"exports"])}).call(b,c(10)(a),c(8).setImmediate,c(9))},function(a){var b=1,c={};a.exports=c,c.rvalid=/^\{?[0-9a-f]{8}\-?[0-9a-f]{4}\-?[0-9a-f]{4}\-?[0-9a-f]{4}\-?[0-9a-f]{12}\}?$/i;var d;if("undefined"!=typeof window)d=function(){var a=new Uint8Array(b);return window.crypto.getRandomValues(a),[].slice.call(a)[0]};else{var e=require("crypto");d=function(){try{var a=e.randomBytes(b),c=new Uint8Array(a);return[].slice.call(c)[0]}catch(d){}}}c.v4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=15&d(),c="x"===a?b:3&b|8;return c.toString(16)})}},function(a){a.exports=function(a){return function(){var b,c;if(!a.__locked){a.__locked=!0;try{b=a.apply(this,arguments)}catch(d){c=d}}if(a.__locked=!1,c)throw c;return b}}},function(a){var b;a.exports=b=function(){},b.prototype={on:function(a,b){var c;return null==this._listeners&&(this._listeners={}),c=this._listeners,null==c[a]&&(c[a]=[]),c[a].includes(b)?void 0:c[a].push(b)},off:function(a,b){var c,d;if(null!=this._listeners)return d=this._listeners,c=d[a].indexOf(b),-1!==c?d[a].splice(c,1):void 0},emit:function(a){var b,c,d,e,f,g;if(null!=this._listeners&&(d=this._listeners,c=d[a],null!=c)){for(a.target=this,g=[],e=0,f=c.length;f>e;e++)b=c[e],g.push(b.call(this,a));return g}}}},function(a,b,c){var d;d=c(7),a.exports=function(a){return""===a?Promise()(!0):d.get(a)},a.exports.get=d.get,a.exports.post=d.post},function(a){var b,c;b=require("../promise"),c=require("request"),a.exports={get:function(a){var d;return d=b(),c.get(a,function(a,b,c){return d(null==a,a||c)}),d},post:function(a,d){var e;return e=b(),d.data&&(d.body=d.data.toString(),delete d.data),d.dataType&&(d.headers={"Content-type":d.dataType},delete d.dataType),c.post(a,d,function(a,b,c){return e(null==a,a||c)}),e}}},function(a,b,c){(function(a,d){var e=c(11).nextTick,f=Array.prototype.slice,g={},h=0;"undefined"!=typeof setTimeout&&(b.setTimeout=function(){return setTimeout.apply(window,arguments)}),"undefined"!=typeof clearTimeout&&(b.clearTimeout=function(){clearTimeout.apply(window,arguments)}),"undefined"!=typeof setInterval&&(b.setInterval=function(){return setInterval.apply(window,arguments)}),"undefined"!=typeof clearInterval&&(b.clearInterval=function(){clearInterval.apply(window,arguments)}),b.enroll=function(a,b){a._timeoutID=setTimeout(a._onTimeout,b)},b.unenroll=function(a){clearTimeout(a._timeoutID)},b.active=function(){},b.setImmediate="function"==typeof a?a:function(a){var c=h++,d=arguments.length<2?!1:f.call(arguments,1);return g[c]=!0,e(function(){g[c]&&(d?a.apply(null,d):a.call(null),b.clearImmediate(c))}),c},b.clearImmediate="function"==typeof d?d:function(a){delete g[a]}}).call(b,c(8).setImmediate,c(8).clearImmediate)},function(a){function b(){}var c=a.exports={};c.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.MutationObserver,c="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};var d=[];if(b){var e=document.createElement("div"),f=new MutationObserver(function(){var a=d.slice();d.length=0,a.forEach(function(a){a()})});return f.observe(e,{attributes:!0}),function(a){d.length||e.setAttribute("yes","no"),d.push(a)}}return c?(window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),d.length>0)){var c=d.shift();c()}},!0),function(a){d.push(a),window.postMessage("process-tick","*")}):function(a){setTimeout(a,0)}}(),c.title="browser",c.browser=!0,c.env={},c.argv=[],c.on=b,c.addListener=b,c.once=b,c.off=b,c.removeListener=b,c.removeAllListeners=b,c.emit=b,c.binding=function(){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(){throw new Error("process.chdir is not supported")}},function(a){a.exports=function(a){return a.webpackPolyfill||(a.deprecate=function(){},a.paths=[],a.children=[],a.webpackPolyfill=1),a}},function(a){function b(){if(!f){f=!0;for(var a,b=e.length;b;){a=e,e=[];for(var c=-1;++c<b;)a[c]();b=e.length}f=!1}}function c(){}var d=a.exports={},e=[],f=!1;d.nextTick=function(a){e.push(a),f||setTimeout(b,0)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}}]);